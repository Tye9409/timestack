// Generated by CoffeeScript 1.3.3
((function(){(function(a){var b;return b=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},$.fn.extend({timestack:function(a){var b,c;return c={click:function(a){return console.log(a.content)},width:"100%",parse:function(a){return moment(a)},dateFormat:"MMM YYYY",displayFormat:function(a,b){return""+a+" - "+b},color:"#eee",span:"year",spanFormats:{year:"YYYY",month:"MMM YYYY",day:"MMM DD, YYYY"}},a=$.extend(c,a),b=function(b,c){var d,e;e=[],d=b.clone().startOf(a.span);while(d<c)e.push(d.clone()),d.add(a.span+"s",1);return e},this.each(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;e=$(this),f=e.children("ul"),f.css("width",a.width).addClass("timestack-events"),j=null,p=null,n=f.children("li").map(function(){var b,c,d;return b=$(this),c=b.attr("data-end"),d={tilNow:!c,start:a.parse(b.attr("data-start")),end:a.parse(c),title:b.attr("data-title"),color:b.attr("data-color")||a.color,li:b},j&&j<d.start||(j=d.start.clone()),p&&p>d.end||(p=d.end.clone()),d}),j.startOf(a.span),p.endOf(a.span),i=p-j;for(v=0,x=n.length;v<x;v++)m=n[v],d=m.li,r=m.start.format(a.dateFormat),k=m.tilNow?"":m.end.format(a.dateFormat),m.timeDisplay=a.displayFormat(r,k),s=$("<em>("+m.timeDisplay+")</em>").addClass("timestack-time"),t=$("<span>"+m.title+" </span>").addClass("timestack-title"),o=$("<span></span>").addClass("timestack-label").append(t).append(s),m.content=d.children().wrapAll("<div class='timestack-content'></div>"),m.content.parent().hide(),u=((m.end-m.start)/i*100).toFixed(2),q=((m.start-j)/i*100).toFixed(2),d.prepend(o).css("margin-left",""+q+"%").css("width",""+u+"%").css("background-color",m.color).click(function(b){return function(){return a.click(b)}}(m));h=b(j,p),u=(1/h.length*100).toFixed(2)-.03+"%",l=a.spanFormats[a.span],c=$("<ul></ul>").addClass("intervals");for(w=0,y=h.length;w<y;w++)g=h[w],$("<li></li>").text(g.format(l)).css("width",u).appendTo(c);return e.append(c)})}})})(jQuery)})).call(this);